(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-eee5b1e6"],{"48c1":function(t,e,a){},"5c72":function(t,e,a){"use strict";var r=a("48c1"),i=a.n(r);i.a},"8b25":function(t,e,a){"use strict";a.d(e,"a",(function(){return i}));var r=a("b775");function i(t){var e={mobile:t};return Object(r["a"])({url:"/api/sms",method:"post",data:e})}},"9c2c":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("a-form",{ref:"formLogin",staticClass:"user-layout-login",attrs:{id:"formLogin",form:t.form},on:{submit:t.handleSubmit}},[a("a-tabs",{attrs:{"active-key":t.customActiveKey,"tab-bar-style":{textAlign:"center",borderBottom:"unset"}},on:{change:t.handleTabClick}},[a("a-tab-pane",{key:"tab1",attrs:{tab:"账号密码登录"}},[t.isLoginError?a("a-alert",{staticStyle:{"margin-bottom":"24px"},attrs:{type:"error","show-icon":"",message:"账号或密码错误"}}):t._e(),t._v(" "),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["email",{initialValue:"admin@admin.com",rules:[{required:!0},{validator:t.handleEmail}],validateTrigger:"change"}],expression:"[\n              'email',\n              {initialValue: 'admin@admin.com', rules: [{ required: true}, { validator: handleEmail }], validateTrigger: 'change'}\n            ]"}],attrs:{size:"large",type:"text",placeholder:"请输入邮箱地址"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1),t._v(" "),a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["password",{initialValue:"Three@0627",rules:[{required:!0,message:"请输入密码"}],validateTrigger:"blur"}],expression:"[\n              'password',\n              {initialValue: 'Three@0627', rules: [{ required: true, message: '请输入密码' }], validateTrigger: 'blur'}\n            ]"}],attrs:{size:"large",type:"password",autocomplete:"false",placeholder:"请输入密码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),t._v(" "),a("a-form-item",[a("a-row",{attrs:{gutter:16}},[a("a-col",{staticClass:"gutter-row",attrs:{span:16}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["captcha",{rules:[{required:!0,message:"请输入图片验证码"}],validateTrigger:"blur"}],expression:"['captcha', {rules: [{ required: true, message: '请输入图片验证码' }], validateTrigger: 'blur'}]"}],attrs:{size:"large",type:"text",placeholder:"图形验证码"},on:{input:t.handleCodeInput}},[a("svg-icon",{attrs:{slot:"prefix","icon-class":"captcha","class-name":"captcha"},slot:"prefix"})],1)],1)],1),t._v(" "),a("a-col",{staticClass:"gutter-row",attrs:{span:8}},[a("el-image",{directives:[{name:"loading",rawName:"v-loading",value:t.captchaLoading,expression:"captchaLoading"}],staticStyle:{width:"120px",height:"40px"},attrs:{src:t.captchaUrl,fit:"contain",alt:"验证码"},on:{click:function(){t.getPictureCaptcha()}}})],1)],1)],1)],1),t._v(" "),a("a-tab-pane",{key:"tab2",attrs:{tab:"手机号登录"}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["mobile",{rules:[{required:!0,pattern:/^1[34578]\d{9}$/,message:"请输入正确的手机号"}],validateTrigger:"change"}],expression:"['mobile', {rules: [{ required: true, pattern: /^1[34578]\\d{9}$/, message: '请输入正确的手机号' }], validateTrigger: 'change'}]"}],attrs:{size:"large",type:"text",placeholder:"手机号"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mobile"},slot:"prefix"})],1)],1),t._v(" "),a("a-row",{attrs:{gutter:16}},[a("a-col",{staticClass:"gutter-row",attrs:{span:16}},[a("a-form-item",[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["sms_code",{rules:[{required:!0,message:"请输入短信验证码"}],validateTrigger:"blur"}],expression:"['sms_code', {rules: [{ required: true, message: '请输入短信验证码' }], validateTrigger: 'blur'}]"}],attrs:{size:"large",type:"text",placeholder:"验证码"}},[a("a-icon",{style:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"message"},slot:"prefix"})],1)],1)],1),t._v(" "),a("a-col",{staticClass:"gutter-row",attrs:{span:8}},[a("a-button",{staticClass:"getCaptcha",attrs:{tabindex:"-1",disabled:t.state.smsSendBtn},domProps:{textContent:t._s(t.state.smsSendBtn?t.state.time+" s":"获取验证码")},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.getCaptcha(e)}}})],1)],1)],1)],1),t._v(" "),a("a-form-item",[a("a-button",{staticClass:"login-button",attrs:{size:"large",type:"primary","html-type":"submit",loading:t.state.loginBtn,disabled:t.state.loginBtn}},[t._v("登录")])],1)],1)],1)},i=[],s=a("db72"),o=a("8b25"),n=a("2f62"),c=a("b775");function l(t){return Object(c["a"])({url:"/api/captcha",method:"post",data:t})}var u={components:{},data:function(){return{customActiveKey:"tab1",loginBtn:!1,isLoginError:!1,form:this.$form.createForm(this),state:{time:60,loginBtn:!1,loginType:0,smsSendBtn:!1},captchaLoading:!1,captchaUrl:void 0,captcha:{code:void 0,key:void 0}}},created:function(){this.getPictureCaptcha()},methods:Object(s["a"])({},Object(n["b"])(["Login","Logout"]),{handleEmail:function(t,e,a){var r=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;r.test(e)?a():a("请输入正确的电子邮件地址")},handleCodeInput:function(t){this.captcha.code=t.target.value},getPictureCaptcha:function(){var t=this;this.captchaLoading=!0,l().then((function(e){e.status&&(t.captcha.key=e.data.captcha_key,t.captchaUrl=e.data.captcha_image_content),t.captchaLoading=!1}))},handleTabClick:function(t){this.customActiveKey=t,this.form.resetFields()},handleSubmit:function(t){var e=this;t.preventDefault();var a=this.form.validateFields,r=this.state,i=this.customActiveKey;r.loginBtn=!0;var s="tab1"===i?["email","password"]:["mobile","sms_code"];a(s,{force:!0},(function(t,a){t||("tab1"===e.customActiveKey&&(a.captcha=e.captcha),console.log("login form",a),e.login(a))}))},login:function(t){var e=this;this.$store.dispatch("user/login",t).then((function(t){t.status?e.loginSuccess():100010===t.code&&e.getPictureCaptcha()})).finally((function(){e.state.loginBtn=!1}))},getCaptcha:function(t){var e=this;t.preventDefault();var a=this.form.validateFields,r=this.state;a(["mobile"],{force:!0},(function(t,a){if(!t){r.smsSendBtn=!0;var i=window.setInterval((function(){r.time--<=0&&(r.time=60,r.smsSendBtn=!1,window.clearInterval(i))}),1e3);o["a"](a.mobile).then((function(t){t.status&&e.$notification["success"]({message:"提示",description:"成功发送验证码",duration:8})}))}}))},loginSuccess:function(t){this.$router.push({path:"/basic"}),this.isLoginError=!1},requestFailed:function(t){this.isLoginError=!0,this.$notification["error"]({message:"错误",description:((t.response||{}).data||{}).message||"请求出现错误，请稍后再试",duration:4})}})},d=u,m=(a("5c72"),a("2877")),p=Object(m["a"])(d,r,i,!1,null,"073091ca",null);e["default"]=p.exports}}]);